<!-- Pull to refresh indicator -->
<div class="pull-to-refresh-indicator"
     [style.height.px]="pullDistance"
     [class.refreshing]="isRefreshing">
    <div class="refresh-icon" [style.opacity]="pullDistance / 60">
        @if (isRefreshing) {
            <i class="fa fa-spinner fa-spin"></i>
        } @else {
            <i class="fa fa-arrow-down"></i>
        }
    </div>
</div>

<div class="row">
    <div class="text-center mt-2">
        <h2>Your matches - {{memberService.paginatedResult()?.pagination?.totalItems}}</h2>
    </div>

    <div class="container mt-2">
        <form #form="ngForm" (ngSubmit)="loadMembers()" class="mb-2">
            <div class="row g-2">
                <div class="col-12 col-sm-6 col-md-auto">
                    <div class="d-flex align-items-center">
                        <label class="col-form-label me-2 text-nowrap">Age from:</label>
                        <input type="number" class="form-control" style="width: 70px;" name="minAge" [(ngModel)]="memberService.userParams().minAge">
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-md-auto">
                    <div class="d-flex align-items-center">
                        <label class="col-form-label me-2 text-nowrap">Age to:</label>
                        <input type="number" class="form-control" style="width: 70px;" name="maxAge" [(ngModel)]="memberService.userParams().maxAge">
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-md-auto">
                    <div class="d-flex align-items-center">
                        <label class="col-form-label me-2 text-nowrap">Show:</label>
                        <select name="gender" style="width: 130px;" class="form-select" [(ngModel)]="memberService.userParams().gender">
                            @for(gender of genderList; track gender.value)
                            {
                                <option [value]="gender.value">{{gender.display}}</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-md-auto">
                    <button class="btn btn-primary w-100" type="submit">Apply filters</button>
                </div>
                <div class="col-12 col-sm-6 col-md-auto">
                    <button (click)="resetFilters()" class="btn btn-info w-100" type="button">Reset filters</button>
                </div>
                <div class="col-12 col-md">
                    <div class="btn-group w-100 d-flex" role="group">
                        <button type="button" class="btn btn-primary flex-fill" name="orderBy" (click)="loadMembers()" btnRadio="lastActive" [(ngModel)]="memberService.userParams().orderBy">Last Active</button>
                        <button type="button" class="btn btn-primary flex-fill" name="orderBy" (click)="loadMembers()" btnRadio="created" [(ngModel)]="memberService.userParams().orderBy">Newest Members</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    @for (member of memberService.paginatedResult()?.items; track member.id) {
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2 mb-2">
        <app-member-card [member]="member"></app-member-card>
    </div>
    }
</div>

@if(memberService.paginatedResult()?.pagination)
{
<div class="d-flex justify-content-center">
    <pagination 
    [boundaryLinks]="true" 
    [totalItems]="memberService.paginatedResult()?.pagination!.totalItems"
    [itemsPerPage]="memberService.paginatedResult()?.pagination!.itemsPerPage" 
    (pageChanged)="pageChanged($event)"
    [(ngModel)]="memberService.paginatedResult()?.pagination!.currentPage"
    [maxSize]="10"
    previousText="&lsaquo;"
    nextText="&rsaquo;" 
    firstText="&laquo;" 
    lastText="&raquo;">
    </pagination>
</div>
}